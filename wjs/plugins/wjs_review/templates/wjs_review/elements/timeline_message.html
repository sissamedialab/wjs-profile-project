{% load wjs_review %}
<div class="row mb-3">
    <div class="col {% if message.read %} bg-muted {% else %} bg-warning {% endif %}">
        <span class="badge bg-light text-muted" title="{{ message.created }}">{{ message.created|date:DATE_FORMAT }}</span>
        <span title="Click view more"><a href="{% url 'wjs_article_messages' article_id=workflow.article.id %}#msg-{{ message.id }}"
   class="text-decoration-none">{{ message.subject|truncatewords:4 }}</a></span>
        {% if message.actor != user %}
            {% with actor_role=workflow.article|role_for_article_tt:message.actor %}
                {% if actor_role %}<span>(from {{ actor_role }})</span>{% endif %}
            {% endwith %}
        {% endif %}
        {# hijacked actions are always shown, users without roles (superusers) have a generic "Staff" label #}
        {% if message.hijacking_actor and message.hijacking_actor != user and message.actor == user %}
            {% with actor_role=workflow.article|role_for_article_tt:message.hijacking_actor %}
                <span>(Impersonated by {{ actor_role|default:"Staff" }})</span>
            {% endwith %}
        {% endif %}
    </div>
</div>
