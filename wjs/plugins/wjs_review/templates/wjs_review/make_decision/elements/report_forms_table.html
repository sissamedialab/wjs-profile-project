{% load django_bootstrap5 static %}
{% load wjs_review wjs_tags %}
<!-- djlint:off -->
{% translate "<i class=\"bi bi-clipboard-fill\"></i> Read the review" as read_review_label %}
<!-- djlint:on -->
{% translate "Review for editor" as editor_cover_letter_modal_title %}
{% translate "Review for author" as author_review_modal_title %}
<h5>{% translate "Reviewers Feedback" %}</h5>
<table class="table table-hover table-striped table-bordered mt-4" id="report-forms">
  <thead class="bg-light">
    <tr>
      <th class="col-2"></th>
      {% for review in submitted_reviews %}
          <th class="col-2">{{ review.reviewer }}</th>
      {% endfor %}
    </tr>
  </thead>
  <tbody>
    {% for field_name, field in form_fields.items %}
      <tr>
        {% if field_name != 'author_file_title' %}
          <th>{% translate field.label %}</th>
          {% for review in submitted_reviews %}
              {% if field_name != 'review_file' and field_name != 'editor_cover_letter' and field_name != 'author_review' %}
                <td>
                  {{ review.workflowreviewassignment.report_form_answers|keyvalue:field_name }}
                </td>
              {% elif field_name == 'editor_cover_letter' %}
                {% with modal_id="editor_cover_letter_modal-"|concat:review.pk modal_target="#editor_cover_letter_modal-"|concat:review.pk modal_content=review.workflowreviewassignment.report_form_answers|keyvalue:'editor_cover_letter' %}
                <td>
                  {% bootstrap_button type="button" content=read_review_label button_class="btn-outline-primary" data_bs_toggle="modal" data_bs_target=modal_target %}
                  {% include "wjs_review/base/elements/modal.html" with modal_id=modal_id modal_title=editor_cover_letter_modal_title modal_body=modal_content %}
                </td>
                {% endwith %}
              {% elif field_name == 'author_review' %}
                {% with modal_id="author_review_modal-"|concat:review.pk modal_target="#author_review_modal-"|concat:review.pk modal_content=review.workflowreviewassignment.report_form_answers|keyvalue:'author_review' %}
                <td>
                  {% bootstrap_button type="button" content=read_review_label button_class="btn-primary" data_bs_toggle="modal" data_bs_target=modal_target %}
                  {% include "wjs_review/base/elements/modal.html" with modal_id=modal_id modal_title=author_review_modal_title modal_body=modal_content %}
                </td>
                {% endwith %}
              {% elif field_name == 'review_file' and review.review_file %}
                {% url 'article_file_download' 'id' workflow.article.pk review.review_file.pk as download_file %}
                {% with author_file_title=review.workflowreviewassignment.report_form_answers|keyvalue:'author_file_title' %}
                <!-- djlint:off -->
                {% with author_file_label="<i class=\"bi bi-filetype-txt\"></i> "|concat:author_file_title %}
                <!-- djlint:on -->
                <td>
                  {% bootstrap_button type="link" href=download_file content=author_file_label|safe button_class="btn-outline-primary" %}
                </td>
                {% endwith %}
                {% endwith %}
              {% else %}
                <td></td>
              {% endif %}
          {% endfor %}
        {% endif %}
      </tr>
    {% endfor %}
  </tbody>
</table>
