{% load roles wjs_tags %}
{% user_has_role request 'section-editor' as user_is_editor %}
{% user_has_role request 'author' as user_is_author %}
{% user_has_role request 'reviewer' as user_is_reviewer %}
{% user_has_role request 'director' as user_is_director %}

{% url 'submission_start' as submission_start %}
{% url 'core_manager_index' as core_manager_index %}
{% url 'manage_archive_article' article.pk as manage_archive_article %}
{% url 'manage_issues_id' issue.pk as manage_issues_id %}
{% url 'core_edit_profile' as core_edit_profile %}
{% url 'core_logout' as core_logout %}
{% url 'wjs_review_author_pending' as wjs_review_author_pending %}
{% url 'wjs_review_reviewer_pending' as wjs_review_reviewer_pending %}
{% url 'wjs_review_list' as wjs_review_list %}
{% url 'wjs_review_eo_pending' as wjs_review_eo_pending %}
{% url 'wjs_review_director_pending' as wjs_review_director_pending %}
{% url 'core_edit_settings_group' 'submission' as core_edit_settings_group_submission %}
{% url 'core_edit_settings_group' 'journal' as core_edit_settings_group_journal %}
{% url 'cms_page_edit' page.pk as cms_page_edit %}
{% url 'core_editorial_team' as core_editorial_team %}
{% url 'manage_archive_article' article.pk as manage_archive_article %}
{% url 'manage_issues_id' issue.pk as manage_issues_id %}
{% url 'core_manager_edit_news' news_item.pk as core_manager_edit_news %}
<div class="dropdown">
  <button class="btn btn-outline-primary dropdown-toggle btn-sm" type="button" id="user-menu" data-bs-toggle="dropdown" aria-expanded="false">
    {% if view.role %}
      {% translate "Viewing as" %}: {{ view.role }}
    {% else %}
      {% translate "Profile" %}
    {% endif %}
  </button>
  <ul class="dropdown-menu" aria-labelledby="user-menu">
    {% if not journal_settings.general.disable_journal_submission and submission_start %}
      <li>
        <a class="dropdown-item" href="{{ submission_start }}">{% trans "Submit" %}</a>
      </li>
    {% endif %}
    {% if user_is_author and wjs_review_author_pending %}
      <li>
        <a class="dropdown-item" href="{{ wjs_review_author_pending }}">{% trans "My Author Pages" %}</a>
      </li>
    {% endif %}
    {% if user_is_reviewer and wjs_review_reviewer_pending %}
      <li>
        <a class="dropdown-item" href="{{ wjs_review_reviewer_pending }}">{% trans "My Reviewer Pages" %}</a>
      </li>
    {% endif %}
    {% if user_is_editor and wjs_review_list %}
      <li>
        <a class="dropdown-item" href="{{ wjs_review_list }}">{% trans "My Editor Pages" %}</a>
      </li>
    {% endif %}
    {% if user_is_director and wjs_review_director_pending %}
      <li>
        <a class="dropdown-item" href="{{ wjs_review_director_pending }}">{% trans "My Director Pages" %}</a>
      </li>
    {% endif %}
    {% if request.user|is_user_eo and wjs_review_eo_pending %}
      <li>
        <a class="dropdown-item" href="{{ wjs_review_eo_pending }}">{% trans "My EO Pages" %}</a>
      </li>
    {% endif %}
    {% if request.user.is_staff or request.user|is_user_eo %}
      <li>
        <a class="dropdown-item" href="{{ core_manager_index }}">{% trans "Manager" %}</a>
      </li>
      {% if request.resolver_match.url_name and request.resolver_match.url_name == 'journal_submissions' %}
        <li>
          <a href="{{ core_edit_settings_group_submission }}">{% trans "Edit Submissions Page" %}</a>
        </li>
        <li>
          <a href="{{ core_edit_settings_group_journal }}">{% trans "Edit Journal Info" %}</a>
        </li>
      {% endif %}
      {% if request.resolver_match.url_name and request.resolver_match.url_name == 'cms_page' and page %}
        <li>
          <a href="{{ cms_page_edit }}">{% trans "Edit Page" %}</a>
        </li>
      {% endif %}
      {% if request.resolver_match.url_name and request.resolver_match.url_name == 'editorial_team' and core_editorial_team %}
        <li>
          <a href="{{ core_editorial_team }}">{% trans "Manage Editorial Team" %}</a>
        </li>
      {% endif %}
      {% if request.resolver_match.url_name and request.resolver_match.url_name == 'article_view' and article and manage_archive_article %}
        <li>
          <a class="dropdown-item"
             href="{{ manage_archive_article }}">{% trans "Edit Article" %}</a>
        </li>
      {% endif %}
      {% if request.resolver_match.url_name and request.resolver_match.url_name == 'journal_issue' and issue and manage_issues_id %}
        <li>
          <a class="dropdown-item" href="{{ manage_issues_id }}">{% trans "Edit Issue" %}</a>
        </li>
      {% endif %}
      {% if request.resolver_match.url_name and request.resolver_match.url_name == 'core_news_item' and news_item and core_manager_edit_news %}
        <li>
          <a class="dropdown-item"
             href="{{ core_manager_edit_news }}">{% trans "Edit News Item" %}</a>
        </li>
      {% endif %}
    {% endif %}
    {% if request.user.is_staff %}
      <li>
        <a class="dropdown-item" href="{% url "admin:index" %}">{% trans "Admin" %}</a>
      </li>
    {% endif %}
    {% if core_edit_profile %}
      <li>
        <a class="dropdown-item" href="{{ core_edit_profile }}">{% trans "Profile" %}</a>
      </li>
    {% endif %}
    {% if core_logout %}
      <li>
        <a class="dropdown-item" href="{{ core_logout }}">{% trans "Logout" %}</a>
      </li>
    {% endif %}
  </ul>
</div>
