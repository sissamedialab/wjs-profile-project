{% load django_bootstrap5 files %}
{# djlint:off #}
{% translate "<i class=\"bi bi-cloud-arrow-down-fill\"></i> Download" as download_label %}
{% translate "<i class=\"bi bi-cloud-arrow-up-fill\"></i> Upload" as upload_label %}
{% translate "<i class=\"bi bi-trash3-fill\"></i>" as delete_label %}
{% translate "return confirm('Are you sure you want to delete this item?');" as confirm_label %}
{# djlint:on #}
<table id="do_revision_files" class="table table-files">
  <tr>
    <th>{% translate "Label" %}</th>
    <th>{% translate "Filename" %}</th>
    <th>{% translate "Type" %}</th>
    <th>{% translate "Uploaded" %}</th>
    <th>{% translate "Size" %}</th>
    <th>{% translate "Download" %}</th>
    {% if enable_upload %}
      <th>{% translate "Upload Revised File" %}</th>
      <th>{% translate "Delete" %}</th>
    {% endif %}
  </tr>
  {% for file in files %}
    {% url 'download_single_file' article.pk file.pk as download_file_url %}
    {% url "wjs_replace_article_file" article.pk revision_request.pk file_type file.pk as replace_file_url %}
    {% url "wjs_delete_article_file" article.pk revision_request.pk file.pk as delete_file_url %}
    <tr>
      <td>{{ file.label }}</td>
      <td>{{ file.original_filename }}</td>
      <td>{{ type_label }}</td>
      <td>{{ file.date_uploaded|date:"Y-m-d G:i" }}</td>
      <td>{% file_size file article %}</td>
      <td>
        {% bootstrap_button button_class="btn-outline-secondary" href=download_file_url content=download_label %}
      </td>
      {% if enable_upload %}
        <td>
          {% bootstrap_button button_class="btn-outline-secondary" content=upload_label data_bs_toggle="modal" data_bs_target="#htmxModal" hx_trigger="click" hx_get=replace_file_url hx_target="#htmxModalContent" %}
        </td>
        <td>
          <form method="post" action="{{ delete_file_url }}">
            {% csrf_token %}
            <input value="{{ request.path_info }}#do_revision_files" name="next" type="hidden">
            {% bootstrap_button name="delete" button_type="submit" button_class="btn-outline-secondary" onclick=confirm_label content=delete_label %}
          </form>
        </td>
      {% endif %}
    </tr>
  {% endfor %}
</table>
